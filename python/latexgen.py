#!/usr/bin/env python

import os
import base64
import argparse
template = """JSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJQolIExvYWQgUHJlYW1wbGUgICAgICAgICAlCiUlJSUl
JSUlJSUlJSUlJSUlJSUlJSUlJSUKClxkb2N1bWVudGNsYXNzW2E0LCBlbmdsaXNoXXthcnRpY2xl
fQoKJUltcG9ydCBmcm9tIHRoZSBzYW1lIGZvbGRlcgolXGlucHV0e3ByZWFtYmxlX2VuLnRleH0K
CiVJbXBvcnQgZnJvbSBhYnNvbHV0ZSBwYXRoCiVcdXNlcGFja2FnZXtpbXBvcnR9CiVcaW1wb3J0
e0M6L0dpdEh1Yi9MYVRlWF9QcmVhbWJsZV9hbmRfRXhhbXBsZXMvcHJlYW1ibGUvfXtwcmVhbWJs
ZV9kay50ZXh9CgolSW1wb3J0IGZyb20gYSByZWxhdGl2ZSBwYXRoClx1c2VwYWNrYWdle2ltcG9y
dH0KXHN1YmltcG9ydHsuLi9wcmVhbWJsZS99e3ByZWFtYmxlX2VuLnRleH0KCiUlJSUlJSUlJSUl
JSUlJSUlJSUlJSUlJSUKJSBEb2N1bWVudCBzdGFydHMgaGVyZSEgJQolJSUlJSUlJSUlJSUlJSUl
JSUlJSUlJSUlCgpcYmVnaW57ZG9jdW1lbnR9CgolIERlZmluZSB0aXRsZSBhbmQgbW9yZSBvbiBm
cm9udHBhZ2UKCVxzZXR0aXRsZXtUaXRsZX17U3VidGl0bGV9CiAgICBcYWRkYXV0aHtTdGVmZmFu
IFPDuGx2c3Rlbn17MjAxNTA1ODMyQHBvc3QuYXUuZGt9e1wsIGF1NTM0MDY4fQpcbWFrZXRpdGxl
CgpcYmVnaW57YWJzdHJhY3R9Clxub2luZGVudApMb3JlbSBpcHN1bSBkb2xvciBzaXQgYW1ldCwg
Y29uc2VjdGV0dXIgYWRpcGlzY2luZyBlbGl0LCBzZWQgZG8gZWl1c21vZCB0ZW1wb3IgaW5jaWRp
ZHVudCB1dCBsYWJvcmUgZXQgZG9sb3JlIG1hZ25hIGFsaXF1YS4gVXQgZW5pbSBhZCBtaW5pbSB2
ZW5pYW0sIHF1aXMgbm9zdHJ1ZCBleGVyY2l0YXRpb24gdWxsYW1jbyBsYWJvcmlzIG5pc2kgdXQg
YWxpcXVpcCBleCBlYSBjb21tb2RvIGNvbnNlcXVhdC4KXGVuZHthYnN0cmFjdH0KClx0YWJsZW9m
Y29udGVudHMKClxuZXdwYWdlClxzZWN0aW9ue0ludHJvZHVjdGlvbn0gXGxhYmVse3NlYzppbnRy
b30KTG9yZW0gaXBzdW0gZG9sb3Igc2l0IGFtZXQsIGNvbnNlY3RldHVyIGFkaXBpc2NpbmcgZWxp
dCwgc2VkIGRvIGVpdXNtb2QgdGVtcG9yIGluY2lkaWR1bnQgdXQgbGFib3JlIGV0IGRvbG9yZSBt
YWduYSBhbGlxdWEuIFV0IGVuaW0gYWQgbWluaW0gdmVuaWFtLCBxdWlzIG5vc3RydWQgZXhlcmNp
dGF0aW9uIHVsbGFtY28gbGFib3JpcyBuaXNpIHV0IGFsaXF1aXAgZXggZWEgY29tbW9kbyBjb25z
ZXF1YXQuCgoKClxiZWdpbnt0aGViaWJsaW9ncmFwaHl9ezl9ClxiaWJpdGVte2JpYml0ZW19CglM
YXN0LCBGaXJzdDogXGVtcGh7VGl0bGV9LCBwdWJsaWNhdGlvbiwgZWRpdGlvbiwgeWVhcgpcZW5k
e3RoZWJpYmxpb2dyYXBoeX0KXGJpYmxpb2dyYXBoeXN0eWxle2FiYnJ2fQpcYmlibGlvZ3JhcGh5
e3JlZmVyZW5jZXJ9CgpcbmV3cGFnZQpcYXBwZW5kaXgKXHNlY3Rpb257QXBwZW5kaXh9CkxvcmVt
IGlwc3VtIGRvbG9yIHNpdCBhbWV0LCBjb25zZWN0ZXR1ciBhZGlwaXNjaW5nIGVsaXQsIHNlZCBk
byBlaXVzbW9kIHRlbXBvciBpbmNpZGlkdW50IHV0IGxhYm9yZSBldCBkb2xvcmUgbWFnbmEgYWxp
cXVhLiBVdCBlbmltIGFkIG1pbmltIHZlbmlhbSwgcXVpcyBub3N0cnVkIGV4ZXJjaXRhdGlvbiB1
bGxhbWNvIGxhYm9yaXMgbmlzaSB1dCBhbGlxdWlwIGV4IGVhIGNvbW1vZG8gY29uc2VxdWF0LgoK
XGVuZHtkb2N1bWVudH0=
"""
preamble_base = """JSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUKJSAgICBQYXBlcnNpemUgYW5kIGVuY29k
aW5nICAgICUKJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUKCiUgU2l6ZSBvZiBtYXJn
aW5zIGNhbiBiZSBjaGFuZ2VkIGhlcmUgaW4gdGhlIG91dGNvbW1lbnRlZCB2ZXJzaW9uIQolXHVz
ZXBhY2thZ2VbYTRwYXBlciwgdG90YWw9ezZpbiwgOGlufV17Z2VvbWV0cnl9CSV0b3RhbD17d2lk
dGgsIGhlaWdodH0KXHVzZXBhY2thZ2VbYTRwYXBlcl17Z2VvbWV0cnl9CgolIEJhc2ljczogZm9u
dCwgY29kZWMgZXRjLgpcdXNlcGFja2FnZVt1dGY4XXtpbnB1dGVuY30JCQkJCQklIGVuY29kaW5n
OiB1dGYtOCAobm9yZGljIGxldHRlcnMpClx1c2VwYWNrYWdlW1QxXXtmb250ZW5jfQkJCQkJCSUg
dXNlIDgtYml0IGVuY29kZWQgZm9udHMKXHJlbmV3Y29tbWFuZHtcc2ZkZWZhdWx0fXtwaHZ9CQkJ
CQklIGNoYW5nZXMgdGhlIGRlZmF1bHQgZm9udAoKJVx1c2VwYWNrYWdlW3BhcmZpbGxde3BhcnNr
aXB9ICAgICAgJUluc3RlYWQgb2YgaW5kZW50aW5nIG9uIGEgbmV3bGluZSBhZGRzIHdoaXRlc3Bh
Y2UKCgoKJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUKJSAgICAgIFRhYmxlcyBhbmQg
ZmlndXJlcyAgICAgICUKJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUKClx1c2VwYWNr
YWdle3RhYnVsYXJ4LGJvb2t0YWJzLGF1dGhibGt9CQkgICAgJSB2YXJpb3VzIGJhc2ljIHN0dWZm
IGZvciB0YWJsZXMgYW5kIG1vcmUKCiUgRmlndXJlcyBhbmQgY2FwdGlvbnMKXHVzZXBhY2thZ2V7
Y2FwdGlvbn0JCQkJCQkJJSBjcmVhdGUgY2FwdGlvbnMgZm9yIGZpZ3VyZXMKXHVzZXBhY2thZ2V7
c3ViZmlnfQkJCQkJCQkJJSBjcmVhdGUgc3ViZmlndXJlcyBvZiBhIGZpZ3VyZQolXHVzZXBhY2th
Z2V7c3ViY2FwdGlvbn0JCQkJCSUgY3JlYXRlIGNhcHRpb25zIGZvciBzdWJmaWd1cmVzCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAlICAgICBjdXJyZW50bHkgb2ZmLCBkdWUgdG8g
Y29uZmxpY3RzCgpcdXNlcGFja2FnZXt3cmFwZmlnfQkJCQkJCQklIGxldHRpbmcgZmlndXJlcyBi
ZSBpbiB0ZXh0CgpcdXNlcGFja2FnZXtyb3RhdGluZ30gICAgICAgICAgICAgJSBsZXQgYW55IGVu
dmlyb25tZW50IGJlIHJvdGF0ZWQgKGZpZ3VyZXMgc2lkZXdheXMpCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAlICAgICBcYmVnaW57c2lkZXdheXN9IG9yIFxiZWdpbnt0dXJufXsz
MH0KCgoKJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlCiUgICAgICAgICAgIFZh
cmlhYmxlcyAgICAgICAgICAgICAgJQolJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUl
JSUKXHVzZXBhY2thZ2V7cGdma2V5c30JCQklSW5pdGlhbGl6ZSB0aGUgdmFyaWFibGUga2V5LXZh
bHVlIHBhcmlycwoKXG5ld2NvbW1hbmR7XHNldHZhbHVlfVsxXXtccGdma2V5c3svdmFyaWFibGVz
LyMxfX0KXG5ld2NvbW1hbmR7XGdldHZhbHVlfVsxXXtccGdma2V5c3ZhbHVlb2Z7L3ZhcmlhYmxl
cy8jMX19ClxuZXdjb21tYW5ke1xkZWNsYXJlfVsxXXslCiBccGdma2V5c3sKICAvdmFyaWFibGVz
LyMxLmlzIGZhbWlseSwKICAvdmFyaWFibGVzLyMxLnVua25vd24vLnN0eWxlID0ge1xwZ2ZrZXlz
Y3VycmVudHBhdGgvXHBnZmtleXNjdXJyZW50bmFtZS8uaW5pdGlhbCA9ICMjMX0KIH0lCn0KClxk
ZWNsYXJle30KCgoKJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUKJSAgICAgIExhVGVY
IFByb2dyYW1taW5nICAgICAgICUKJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUKClx1
c2VwYWNrYWdle3hwYXJzZX0JCQkJCQkJCSUgU2Nhbm5pbmcgYXJndW1lbnRzClx1c2VwYWNrYWdl
e2lmdGhlbn0JCQkJCQkJCSUgQ29uZGl0aW9uYWxzClx1c2VwYWNrYWdle2NhbGN9CQkJCQkJCQkl
IENhbGN1bGF0aW9ucwoKCgolJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJQolICAgICAg
ICAgIEh5cGVybWVkaWEgICAgICAgICAgJQolJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUl
JQoKXHVzZXBhY2thZ2V7dXJsLCBoeXBlcnJlZn0JCQkJCQkJJSBcdXJse2xpbmt9IGFuZCBcaHJl
ZntsaW5rfXtyZXBsYWNpbmcgdGV4dH0KCiVNYWNyb3MgdGFrZW4gZnJvbSB0aGUgcHJlYW1ibGUg
b2YgdGhlIE1hdEZ5c1R1dG9yIExhVGVYIEd1aWRlLgpcbmV3Y29tbWFuZCp7XGh0dHB9WzFde1xo
cmVme2h0dHA6Ly8jMX17IzF9fQkJJSBtYWNybyBmb3IgaHR0cCBsaW5rczogXGh0dHB7d3d3Lm1h
dGZ5c3R1dG9yLmRrfQpcbmV3Y29tbWFuZCp7XG1haWx0b31bMV17XGhyZWZ7bWFpbHRvOiMxfXsj
MX19CQklIG1hY3JvIGZvciBtYWlsczogXG1haWx0b3tlbWFpbEBlbWFpbC5jb219CgolJSUlJSUl
JSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJQolICAgICAgICAgU3R5bGl6YXRpb24gICAgICAgICAg
JQolJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJQoKJSBIZWFkZXJzIG9nIGZvb3RlcnMK
XHVzZXBhY2thZ2V7bGFzdHBhZ2V9ICAgICAgICAgICAgICAgICAgICAgICAgICAgJSBcbGFzdHBh
Z2UgY29tbWFuZCBmb3IgbnVtYmVycyBvZiBwYWdlcwpcdXNlcGFja2FnZXtmYW5jeWhkcn0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAlIGNyZWF0ZSBjb29sIGhlYWRlcnMgYW5kIGZvb3RlcnMK
XHBhZ2VzdHlsZXtmYW5jeX0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJSB3aG8gZG9l
c24ndCB3YW50IHRoZWlyIHBhZ2UgdG8gYmUgZmFuY3k/CgolIFVzZSBvZiBjb2x1bW5zClx1c2Vw
YWNrYWdle211bHRpY29sfQoKJSBRdW90YXRpb25zCiUgImRhbmlzaCIgb3IgImJyaXRpc2giClx1
c2VwYWNrYWdlW2RhbmlzaD1ndWlsbGVtZXRzXXtjc3F1b3Rlc30gICAgCSUgdHdvIHN0eWxlczog
InF1b3RlcyIgb3IgPj5ndWlsbGVtZXRzPDwKJVxNYWtlQXV0b1F1b3Rle8K7fXvCq30gICAgICAg
ICAgICAgICAgICAgICAgIAklIGRlY29tbWVudCBmb3IgZWFzeSBtYWNybwolXE1ha2VBdXRvUXVv
dGUqe+KAun174oC5fSAgICAgICAgICAgICAgICAgICAgICAJJSBkZWNvbW1lbnQgZm9yIGV2ZW4g
ZWFzaWVyIG1hY3JvcwoKJSBMaWtlIGEgcGFyYWdyYXBoLCBidXQgYWRkcyBhbHNvIGEgbGluZWJy
ZWFrIGFmdGVyLiAoQWxzbyBpcyBub3QgcmVjb3JkZWQgb24gbGFiZWxsaW5nKQpcbmV3Y29tbWFu
ZHtcbGJwYXJhZ3JhcGh9WzFde1x2c3BhY2V7MC4zZW19IFxub2luZGVudCBcdGV4dGJmeyMxfVxc
IFxub2luZGVudH0KCiUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlCiUgICAgICAgICAg
ICAgTWF0aCAgICAgICAgICAgICAlCiUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlCiVc
bmV3Y29tbWFuZHtcaG1tYXh9ezB9CQkJCQkJCQklIG1pbmltaXplcyB0aGUgYW1vdW50IG9mIGJv
bGQgZmFtaWxpZXMKJVxuZXdjb21tYW5ke1xibW1heH17MX0JCQkJCQkJCSUgdGhpcyBhbGxvd3Mg
Zm9yIG1vcmUgbWF0aCBmYW1pbGllcwoKJSB2YXJpb3VzIGJhc2ljIHN0dWZmClx1c2VwYWNrYWdl
e2JtLCBtYXRodG9vbHMsIGFtc21hdGh9CgolIFZhcmlvdXMgc3ltYm9sIHBhY2thZ2VzClx1c2Vw
YWNrYWdle2Ftc3N5bWJ9CiVcdXNlcGFja2FnZVt1dG9waWFde21hdGhkZXNpZ259CQkJCQklIGZ1
bGwgb3ZlcndyaXRlIG9mIHRoZSBmb250IHN5c3RlbQpcdXNlcGFja2FnZXtzdG1hcnlyZH0JCQkJ
CQkJCSUgZXZlbiBtb3JlIHN5bWJvbHMKCiVcbGV0XG1hdGhjYWxcdW5kZWZpbmVkCQkJCQkJCQkl
IExldCdzIHJlZGVmaW5lIHRoZSBtYXRoY2FsIGFscGhhYmV0CiVcRGVjbGFyZU1hdGhBbHBoYWJl
dHtcbWF0aGNhbH17T01TfXtjbXN5fXttfXtufQoKJSBNYXRoIHNob3J0Y3V0cwpccmVuZXdjb21t
YW5ke1xkfXtcLCBcbWF0aHJte2R9fSAgICAgICAgICAgICAgICAgICAgJSBcZCA9IGRpZmZlcmVu
dGlhbCBkIHdpdGggYSBiaXQgb2Ygc3BhY2luZwpcbmV3Y29tbWFuZHtcZX17XG1hdGhybXtlfX0g
ICAgICAgICAgICAgICAgICAgICAgICAgJSBcZSA9IGV1bGVycyBudW1iZXIKXG5ld2NvbW1hbmR7
XFJ9e1xtYXRoYmJ7Un19ICAgICAgICAgICAgICAgICAgICAgICAgICUgXFIgPSBSZWFsIG51bWJl
cnMKXG5ld2NvbW1hbmR7XE59e1xtYXRoYmJ7Tn19ICAgICAgICAgICAgICAgICAgICAgICAgICUg
XE4gPSBOYXR1cmFsIG51bWJlcnMKXG5ld2NvbW1hbmR7XEN9e1xtYXRoYmJ7Q319ICAgICAgICAg
ICAgICAgICAgICAgICAgICUgXEMgPSBDb21wbGV4IG51bWJlcnMKXG5ld2NvbW1hbmR7XFF9e1xt
YXRoYmJ7UX19ICAgICAgICAgICAgICAgICAgICAgICAgICUgXFEgPSBSYXRpb25hbCBudW1iZXJz
ClxuZXdjb21tYW5ke1xGfXtcbWF0aGJie0Z9fQkJCQkJCQklIFxGCgpcRGVjbGFyZVBhaXJlZERl
bGltaXRlclxjZWlse1xsY2VpbH17XHJjZWlsfSAgICAgICAgJSBcY2VpbHthcmd9CVxjZWlsKnth
cmd9IGZvciBhdXRvbWF0aWMgc2NhbGluZwpcRGVjbGFyZVBhaXJlZERlbGltaXRlclxmbG9vcntc
bGZsb29yfXtccmZsb29yfSAgICAgJSBcZmxvb3J7YXJnfQlcZmxvb3Iqe2FyZ30gZm9yIGF1dG9t
YXRpYyBzY2FsaW5nClxEZWNsYXJlUGFpcmVkRGVsaW1pdGVyXGFic3tcbHZlcnR9e1xydmVydH0g
ICAgICAgICAlIFxhYnN7YXJnfQkJXGFicyp7YXJnfSBmb3IgYXV0b21hdGljIHNjYWxpbmcKClxu
ZXdjb3VudGVye2l9CgpcRGVjbGFyZURvY3VtZW50Q29tbWFuZCBcc2VxIHsgZyBnIGcgZyB9IHsJ
CQklIFxzZXF7eH17aX17an17c30KCVxzZXRjb3VudGVye2l9ezB9CQkJCQkJCQklIHhfaSwgeF9p
K3MsIC4uLiB4X2oKCVxJZlZhbHVlVCB7IzJ9IHsgXGFkZHRvY291bnRlcntpfXsjMn0gfQoJXElm
VmFsdWVURiB7IzF9CgkJeyMxfQoJCXt4fQoJX3sgXGFyYWJpY3tpfSB9LAoJXElmVmFsdWVURiB7
IzR9IAoJCXtcYWRkdG9jb3VudGVye2l9eyM0fX0KCQl7XGFkZHRvY291bnRlcntpfXsxfX0KCVxJ
ZlZhbHVlVEYgeyMxfSAKCQl7IzF9CgkJe3h9IAoJX3sgXGFyYWJpY3tpfSB9LAoJXGRvdHMKCVxJ
ZlZhbHVlVEYgeyMzfQoJCXsgLCAjMV97IzN9IH0KCQl7fQp9CgpcRGVjbGFyZURvY3VtZW50Q29t
bWFuZCBcZXJvIHsgZyBnIH0gewkJCQklIFxlcm8ge3gsIHl9CglcYmVnaW57YXJyYXl9e2N9CQkJ
CQkJCQklCXgKCQlcSWZWYWx1ZVRGeyMxfQkJCQkJCQkJJQl+CgkJCXtfeyMxfX0JCQkJCQkJCQkl
CXkKCQkJe1xwaGFudG9te1xzaW19fQoJXFwKCQlcc2ltCglcXAoJCVxJZlZhbHVlVEZ7IzJ9CgkJ
CXteeyMyfX0KCQkJe1xwaGFudG9te1xzaW19fQoJXGVuZHthcnJheX0KfQoKXERlY2xhcmVEb2N1
bWVudENvbW1hbmQgXHNldCB7IG0gZyB9eyAJCQkJJSBcc2V0c3tYfXtDfQoJIFxsZWZ0XGxicmFj
ZQkJCQkJCQkJCSUge1ggfCBDfQoJIAkjMSBcSWZWYWx1ZVQgeyMyfSB7IFwgfCBcICAjMiB9Cgkg
XHJpZ2h0XHJicmFjZQp9CgpcbWFrZWF0bGV0dGVyCQkJCQkJCQkJCSUgYWRkcyB2ZXJ0aWNhbCBs
aW5lcyB0byBtYXRyaWNlcwpccmVuZXdjb21tYW5kKlxlbnZAbWF0cml4WzFdWypcY0BNYXhNYXRy
aXhDb2xzIGNdewogIFxoc2tpcCAtXGFycmF5Y29sc2VwCiAgXGxldFxAaWZuZXh0Y2hhclxuZXdA
aWZuZXh0Y2hhcgogIFxhcnJheXsjMX19ClxtYWtlYXRvdGhlcgoKJSUlJSUlJSUlJSUlJSUlJSUl
JSUlJSUlJSUlJSUlJSUKJSAgICAgIExvZ2ljIGFuZCBwcm9vZnMgICAgICAgICUKJSUlJSUlJSUl
JSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUKCiUgUHJvb2ZzClx1c2VwYWNrYWdle2Ftc3RobX0JCQkJ
CQkJCSUgVGhlb3JlbSBwYWNrYWdlClx0aGVvcmVtc3R5bGV7ZGVmaW5pdGlvbn0JCQkJCQklIHBs
YWluLCBkZWZpbml0aW9uLCByZW1hcmsKJVxzd2FwbnVtYmVycwkJCQkJCQkJCSUgSWYgeW91IHdh
bnQgdG8gaGF2ZSB0aGUgbnVtYmVyIGZpcnN0CgolIExvZ2ljIHBhY2thZ2VzClx1c2VwYWNrYWdl
e2xwbGZpdGNofQkJCQkJCSUgZml0Y2ggc3R5bGUgcHJvb2ZzCgolXHVzZXBhY2thZ2V7bG9naWNw
cm9vZn0JCQkJCSUgYWx0ZXJuYXRpdmUgcGFja2FnZSwgcmVzZW1ibGluZyB0aGUgZEJlckxvZyBi
b29rCiVcc2V0bGVuZ3RoXHN1YnByb29maG9yaXpzcGFjZXsyZW19CQkJJSBJbmRlbnQgZm9yIHN1
YnByb29mcy4gQ2hhbmdlZCBmb3IgZnJlc2ggdmFyaWFibGVzCgoKCiUlJSUlJSUlJSUlJSUlJSUl
JSUlJSUlJSUlJSUlJSUlCiUgICAgICBDb2xvciBhbmQgcHJlc2V0cyAgICAgICAlCiUlJSUlJSUl
JSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlCgolXHVzZXBhY2thZ2V7eGNvbG9yfQkJCQkJCQklIGJh
c2ljIHhjb2xvciBwYWNrYWdlClx1c2VwYWNrYWdlW3RhYmxlLHhjZHJhd117eGNvbG9yfQkJCQkl
IHhjb2xvciBwYWNrYWdlIHdpdGggc3VwcG9ydCBmb3IgdGFibGVzClxkZWZpbmVjb2xvcntsc3RD
b21tZW50fXtyZ2J9ezAuNDUsMC40NSwwLjQ1fQklIGNvZGU6IGNvbW1lbnRzIChHcmV5KQpcZGVm
aW5lY29sb3J7bHN0S2V5fXtyZ2J9ezAuMTMsMC4yMSwxfQkJCSUgY29kZTogcHJpbWFyeSBrZXl3
b3JkcyAoQmx1ZSkKXGRlZmluZWNvbG9ye2xzdEtleTJ9e3JnYn17MSwwLjY2NjY2NywwLjEzNzI2
fSAgJSBjb2RlOiBzZWNvbmRhcnkga2V5d29yZHMgKERheVs5XSBPcmFuZ2UpClxkZWZpbmVjb2xv
cntsc3RTdHJpbmd9e3JnYn17MC4xLDAuNjUsMC4xfQkJJSBjb2RlOiBzdHJpbmdzIChHcmVlbikK
XGRlZmluZWNvbG9ye2xzdEJhc2V9e3JnYn17MC4wLDAuMCwwLjB9CQkJJSBjb2RlOiBiYXNlIChC
bGFjaykKCgoKJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUKJSAgICAgICAgICAgIFRp
a3ogICAgICAgICAgICAgICUKJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUKClx1c2Vw
YWNrYWdle3Rpa3p9CQkJCQkJCQklIGltcG9ydCBiYXNlcGFja2FnZQpcdXNldGlremxpYnJhcnl7
Y2FsY30JCQkJCQkJJSBDb29yZGluYXRlIGNhbGN1YXRpb25zClx1c2V0aWt6bGlicmFyeXtwb3Np
dGlvbmluZ30gICAgICAgICAgICAgICAgICAgICUgUmVsYXRpdmUgcG9zaXRpb25pbmcKXHVzZXRp
a3psaWJyYXJ5e3NoYXBlc30gICAgICAgICAgICAgICAgICAgICAgICAgJSBEZWZpbmluZyBub2Rl
c2hhcGVzIGFuZCBtb3JlIChpc2EgZm9yIEUvUikKCiUgU2ltcGxlIHRyZWUgbWFjcm8gd2l0aCBj
b21wYWJpbGl0eSB0byB0aWt6Clx1c2VwYWNrYWdle3Rpa3otcXRyZWV9CQkJCQkJCSUgaW1wb3J0
IHNpbXBsZSB0cmVlIG1hY3JvClx1c2V0aWt6bGlicmFyeXthcnJvd3N9ICAgICAgICAgICAgICAg
ICAgICAgICAgICUgYXJyb3dzIGZvciB0cmVlcwoKJSBUaWt6IHNldHRpbmdzIGZvciByZWQtYmxh
Y2sgdHJlZXMKXHRpa3pzZXR7CiAgdHJlZW5vZGUvLnN0eWxlID0ge2FsaWduPWNlbnRlciwgaW5u
ZXIgc2VwPTBwdCwgdGV4dCBjZW50ZXJlZCwKICAgIGZvbnQ9XHNmZmFtaWx5fSwKICBhcm5fYi8u
c3R5bGUgPSB7dHJlZW5vZGUsIGNpcmNsZSwgd2hpdGUsIGZvbnQ9XHNmZmFtaWx5XGJmc2VyaWVz
LCBkcmF3PWJsYWNrLAogICAgZmlsbD1ibGFjaywgdGV4dCB3aWR0aD0xLjVlbX0sICAgICAgICAg
ICAgICAlIGJsYWNrIG5vZGUKICBhcm5fci8uc3R5bGUgPSB7dHJlZW5vZGUsIGNpcmNsZSwgd2hp
dGUsIGZvbnQ9XHNmZmFtaWx5XGJmc2VyaWVzLCBkcmF3PXJlZCwKICAgIGZpbGw9cmVkLCB0ZXh0
IHdpZHRoPTEuNWVtfSwgICAgICAgICAgICAgICUgcmVkIG5vZGUKICBhcm5feC8uc3R5bGUgPSB7
dHJlZW5vZGUsIHJlY3RhbmdsZSwgZHJhdz1ibGFjaywgZmlsbD1ibGFjaywKICAgIG1pbmltdW0g
d2lkdGg9MC41ZW0sIG1pbmltdW0gaGVpZ2h0PTAuNWVtfSAgJSBuaWwgbm9kZQp9CgolIFRpa3og
QXV0b21vdGEgZm9yIFR1cmluZyBNYWNoaW5lcwpcdXNldGlremxpYnJhcnl7YXV0b21hdGF9Cgol
IFRpa3ogRS9SIGRpYWdyYW0KXHVzZXRpa3psaWJyYXJ5e2VyfQoKJSBHcmFwaGljcyBhbmQgcGxv
dHMKXHVzZXBhY2thZ2V7Z3JhcGhpY3h9CQkJCQkJCSUgaW1wb3J0IGJhc2VwYWNrYWdlIGZvciBn
cmFwaHMKXHVzZXBhY2thZ2V7cGdmcGxvdHN9CQkJCQkJCSUgaW1wb3J0IHBnZnBsb3RzClx1c2Vw
Z2ZwbG90c2xpYnJhcnl7ZmlsbGJldHdlZW59CQkJCSUgYWRkIGZpbGxCZXR3ZWVuIGNvbW1hbmQK
XHBnZnBsb3Rzc2V0e2NvbXBhdD0xLjEwfQkJCQkJCSUgY2hvb3NlIHZlcnNpb24gb2YgcGdmcGxv
dHMKCiUgTWFjcm8gZm9yIGNpcmNsZSB3aXRoIHN5bWJvbCBpbnNpZGUuClxuZXdjb21tYW5kKlxj
aXJjbGVkWzFdeyBcdGlreltiYXNlbGluZT0oQy5iYXNlKV1cbm9kZVtkcmF3LGNpcmNsZSxpbm5l
ciBzZXA9MC41cHRdKEMpIHsjMX07XCF9CgoKCiUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUl
JSUlCiUgICAgICAgICAgICBDb2RlICAgICAgICAgICAgICAlCiUlJSUlJSUlJSUlJSUlJSUlJSUl
JSUlJSUlJSUlJSUlClxuZXdjb21tYW5ke1xjb2RlfVsxXXt7XHNmICMxfX0JCQkJCSUgXGNvZGV7
WH0gd3JpdGVzIFggaW4gYSBjb2RlLWFwcHJvcHJpYXRlIGZvbnQKCgoKCiUlJSUlJSUlJSUlJSUl
JSUlJSUlJSUlJSUlJSUlJSUlCiUgICAgICAgICBsc3RsaXN0aW5nICAgICAgICAgICAlCiUlJSUl
JSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlCgolIEltcG9ydCBsc3RsaXN0aW5ncyAtIGJlYXV0
aWZ1bCBzb3VyY2Vjb2RlIQpcdXNlcGFja2FnZXtsaXN0aW5nc30KCgolIEN1c3RvbSBsYW5ndWFn
ZSBkZWZpbml0aW9ucwolIERlZmluaXRpb24gb2YgUHNldWRvY29kZQpcbHN0ZGVmaW5lbGFuZ3Vh
Z2V7cHNldWRvY29kZX17CiAga2V5d29yZHM9WzFdewogIAkgICAgIGJ5LCBieSwgZG93bnRvLCBl
bHNlLCBlcnJvciwgZm9yLCBpZiwgcmVwZWF0LCByZXR1cm4sIHRvLCB1bnRpbCwgd2hpbGUsIHdo
aWxlCiAgCX0sCQkJCQkJCQkgICAgCQklIGxpc3Qgb2Yga2V5d29yZHMsIGZpcnN0IGFuZCBsYXN0
IGFyZSBub3QgdXNlZAogIGtleXdvcmRzPVsyXXsKICAgICAgICBhbmQsIGFuZCwgb3IsIE5JTCwg
TklMCiAgfQogIHNlbnNpdGl2ZT1mYWxzZSwJCQkJCQkJCSUga2V5d29yZHMgYXJlIG5vdCBjYXNl
LXNlbnNpdGl2ZQogIG1vcmVjb21tZW50PVtsXXsvL30sCQkJCQkJCSUgbCBpcyBmb3IgbGluZSBj
b21tZW50CiAgbW9yZWNvbW1lbnQ9W3Ndey8qfXsqL30sCQkJCQkJJSBzIGlzIGZvciBzdGFydCBh
bmQgZW5kIGRlbGltaXRlcgogIG1vcmVzdHJpbmc9W2JdIgkJCQkJCQkJJSBzdHJpbmdzIGFyZSBl
bmNsb3NlZCBpbiBkb3VibGUgcXVvdGVzCn0KCgolIFNldHRpbmdzIGZvciBsc3RsaXN0aW5ncwpc
bHN0c2V0e2xhbmd1YWdlPXBzZXVkb2NvZGUsCQkJCQklIGNob29zZSBsYW5ndWFnZQogIGNvbHVt
bnM9ZmxleGlibGUsCQkJCQkJCQklIGxldCB0aGUgYm94IGFsaWduIHRvIHRoZSB3aWR0aCBvZiB0
aGUgcGFnZQogICAgbGl0ZXJhdGU9e8OmfXt7XGFlfX0xe8O4fXt7XG99fTF7w6V9e3tcYWF9fTEJ
JSBhbGxvdyDDpiwgw7ggYW5kIMOlIGluIGNvZGUKICAgICAgICAgICB7w4Z9e3tcQUV9fTF7w5h9
e3tcT319MXvDhX17e1xBQX19MSwJJSAJKHRoaXMgY2hhbmdlIHdhcyB0YWtlbiBmcm9tIHRoZSBw
cmVhbWJsZSBvZiB0aGUgTWF0RnlzVHV0b3IgTGFUZVggR3VpZGUpCiAgYnJlYWtsaW5lcz10cnVl
LAkJCQkJCQkJJSBhdXRvbWF0aWNhbGx5IGJyZWFrIGxpbmVzCiAgYnJlYWthdHdoaXRlc3BhY2U9
dHJ1ZSwJCQkJCQklIGF1dG9tYXRpY2FsbHkgYnJlYWsgc2hvdWxkIHRoZXJlIG9ubHkgYmUgd2hp
dGUgc3BhY2UuCiAgbnVtYmVycz1sZWZ0LAkJCQkJCQkJCSUgbnVtYmVyaW5nOiBub25lLCBsZWZ0
LCByaWdodAogIG51bWJlcnNlcD01cHQsCQkJCQkJCQklIGRpc3RhbmNlIGJldHdlZW4gbGluZW51
bWJlcnMgYW5kIGNvZGUKICBudW1iZXJzdHlsZT1cY29sb3J7bHN0Q29tbWVudH0sCQkJCSUgY2hh
bmdlIHN0eWxlIG9mIG51bWJlcmluZyAtIGN1cnJlbnRseSBncmV5LgogIHN0ZXBudW1iZXI9MSwJ
CQkJCQkJCQklIHN0ZXAgYmV0d2VlbiB0byBsaW5lLW51bWJlcnMuIDEgPSBlYWNoIGxpbmUgaXMg
bnVtYmVyZWQKICBzaG93c3BhY2VzPWZhbHNlLAkJCQkJCQkJJSBzaG93IHNwYWNlcyBldmVyeXdo
ZXJlIC0gYWRkaW5nIHBhcnRpY3VsYXIgdW5kZXJzY29yZXMKICBzaG93c3RyaW5nc3BhY2VzPWZh
bHNlLAkJCQkJCSUgdW5kZXJsaW5lIHNwYWNlcyB3aXRoaW4gc3RyaW5ncyBvbmx5LgogIHNob3d0
YWJzPWZhbHNlLAkJCQkJCQkJJSBzaG93IHRhYnMgd2l0aGluIHN0cmluZ3MgYWRkaW5nIHBhcnRp
Y3VsYXIgdW5kZXJzY29yZXMuCiAgZXNjYXBlaW5zaWRlPXsqQH17QCp9LCAgICAgICAgICAgICAg
ICAJCSUgaWYgeW91IHdhbnQgdG8gYWRkIExhVGVYIHdpdGhpbiB5b3VyIGNvZGUKICBiYXNpY3N0
eWxlPVx0dGZhbWlseSBcY29sb3J7bHN0QmFzZX0sCQkJJSBzZXQgYmFzaWMgY29sb3IKICBjb21t
ZW50c3R5bGU9XGNvbG9ye2xzdENvbW1lbnR9LAkJCQklIHNldCBjb2xvciBvZiBjb21tZW50cwog
IGtleXdvcmRzdHlsZT1bMV1cY29sb3J7bHN0S2V5fSwJCQkJJSBzZXQgY29sb3Igb2YgcHJpbWFy
eSBrZXl3b3JkcwogIGtleXdvcmRzdHlsZT1bMl1cY29sb3J7bHN0S2V5Mn0sCQkJCSUgc2V0IGNv
bG9yIG9mIHNlY29uZGFyeSBrZXl3b3JkcwogIHN0cmluZ3N0eWxlPVxjb2xvcntsc3RTdHJpbmd9
LAkJCQklIHNldCBjb2xvciBvZiBzdHJpbmdzCn0KCiUgbHN0bGlzdGluZyAtIFB1dCBpdCBiZWF1
dGlmdWxseSBpbiB0aGUgbWlkZGxlClxsc3RzZXR7eGxlZnRtYXJnaW49IC4xXHRleHR3aWR0aCAs
ICAgICAJCQkJCQkJJSBsZWZ0bWFyZ2luIGJlaW5nIDEwJSBvZiB0aGUgY3VycmVudCB3aWR0aAog
IHhyaWdodG1hcmdpbj0gLjFcdGV4dHdpZHRoLCAgICAgICAgICAgCQkJCQkJCSUgcmlnaHQgbWFy
Z2luIGFsc28gMTAlCiAgZnJhbWU9Ym90dG9tbGluZSAgICAgICAgICAgICAgICAgICAgICAJCQkJ
CQkJJSBEcmF3IGEgbGluZSBvbiB0aGUgYm90dG9tIG9mIHRoZSBzdXJyb3VuZGluZyBib3gKfQoK
JSBsc3RsaXN0aW5nIGhlYWRlcgpcRGVjbGFyZUNhcHRpb25Gb250e3doaXRlfXtcY29sb3J7d2hp
dGV9fSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICUgZm9udHN0eWxlIG9m
IGNhcHRpb24KXERlY2xhcmVDYXB0aW9uRm9ybWF0e2xpc3Rpbmd9e1xjb2xvcmJveHtncmF5fXtc
cGFyYm94e1xsaW5ld2lkdGh9eyMxIzIjM319fSAgICAlIGNyZWF0ZSBuaWNlIGdyZXkgYm94ZXMg
Zm9yIGNhcHRpb25zClxjYXB0aW9uc2V0dXBbbHN0bGlzdGluZ117Zm9ybWF0PWxpc3RpbmcsbGFi
ZWxmb250PXdoaXRlLHRleHRmb250PXdoaXRlfSAgICAgICAgJSBhcHBseSBzZXR0aW5ncyB0byBs
aXN0aW5nCgoKJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlCiUgICAgICBUaXRs
ZSBhbmQgaW5mb3JtYXRpb24gICAgICAgJQolJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUl
JSUlJSUKXHNldHZhbHVle3RpdGxlID0gS2VlcCBDYWxtIGFuZCBcdGV4dGJhY2tzbGFzaCBzZXR0
aXRsZX0KXHNldHZhbHVle3N1YnRpdGxlID0gfQoKXERlY2xhcmVEb2N1bWVudENvbW1hbmQgXHNl
dHRpdGxlIHsgbSBnIH17IAkJCQklIFxzZXRUaXRsZXt0aXRsZX17c3VidGl0bGV9CgkgXHNldHZh
bHVle3RpdGxlID0gXGh1Z2UgIzF9CgkgXElmVmFsdWVUIHsjMn0geyBcc2V0dmFsdWV7c3VidGl0
bGUgPSBcXCBcbGFyZ2UgIzJ9IH0KfQoKXHNldHZhbHVle25hbWUgPSB9ClxzZXR2YWx1ZXtlbWFp
bCA9IH0KXHNldHZhbHVle2lkID0gfQoKXERlY2xhcmVEb2N1bWVudENvbW1hbmQgXGFkZGF1dGgg
eyBtIGcgZyB9eyAJCQklIFxhZGRBdXRoe25hbWV9e2VtYWlsfXtpZH0KCSBcc2V0dmFsdWV7bmFt
ZSA9ICMxfQoJIFxhdXRob3J7IzF9CgkgXElmVmFsdWVUIHsjMn0gewoJIAlcc2V0dmFsdWV7ZW1h
aWwgPSAjMn0KCSAJXGFmZmlse1xwcm90ZWN0XGhyZWZ7bWFpbHRvOiMyfXsjMn19CgkgfQoJIFxJ
ZlZhbHVlVCB7IzN9IHsKCSAJXHNldHZhbHVle2lkID0gIzN9CgkgfQp9CgpcdGl0bGV7XGdldHZh
bHVle3RpdGxlfSBcZ2V0dmFsdWV7c3VidGl0bGV9fQoKXGRhdGV7XHRvZGF5fQoKXHNldHZhbHVl
e29mID0gb2Z9CgpcbGhlYWR7XHByb3RlY3RcaHJlZntcZ2V0dmFsdWV7ZW1haWx9fXtcZ2V0dmFs
dWV7bmFtZX1cZ2V0dmFsdWV7aWR9fX0KXGNoZWFke30KXHJoZWFke1xub3VwcGVyY2FzZXtcbGVm
dG1hcmt9XCB8IFx0aGVwYWdlXCBcZ2V0dmFsdWV7b2Z9IFxwYWdlcmVme0xhc3RQYWdlfX0KCiVc
bGZvb3R7fQolXGNmb290e30KJVxyZm9vdHt9Cg==
"""
preamble_en = """JSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUKJSBTZXR0aW5ncyBmb3IgZG9jdW1l
bnQgKGVuZ2xpc2gpICUKJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUKCiUgSW5w
dXQgY29tbW9uIGRlZmluaXRpb24KXGlucHV0e3ByZWFtYmxlX2Jhc2UudGV4fQoKCiUlJSUlJSUl
JSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlCiUgICBFbmNvZGluZyBhbmQgaHlwaGVuYXRpb24gICAl
CiUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlCiUgQmFzaWNzOiBmb250LCBjb2RlYyBl
dGMuClx1c2VwYWNrYWdlW2VuZ2xpc2hde2JhYmVsfQkJCQkJCSUgYmFiZWwgaXMgZm9yIGh5cGhl
bmF0aW9uIGFuZCBvdGhlciBnb29kaWVzCgoKCiUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUl
JSUlCiUgICAgICAgICBsc3RsaXN0aW5nICAgICAgICAgICAlCiUlJSUlJSUlJSUlJSUlJSUlJSUl
JSUlJSUlJSUlJSUlClxyZW5ld2NvbW1hbmR7XGxzdGxpc3RpbmduYW1lfXtDb2RlfSAgICAgICAg
ICAgICAgJSBmb3Igb25lIGJsb2NrIG9mIGNvZGUgYWxvbmUKXHJlbmV3Y29tbWFuZHtcbHN0bGlz
dGxpc3RpbmduYW1lfXtMaXN0IG9mIGNvZGV9ICAlIGZvciBtb3JlIHBpZWNlcyBvZiBjb2RlIGlu
IG9uZQoKCgolJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJQolICAgICAgTG9naWMgYW5k
IHByb29mcyAgICAgICAgJQolJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJQolIFRoZW9y
ZW0gZW52aXJvbm1lbnRzClxuZXd0aGVvcmVte3RoZW9yZW19e1RoZW9yZW19W3NlY3Rpb25dClxu
ZXd0aGVvcmVte2xlbW1hfXtMZW1tYX1bc2VjdGlvbl0KXG5ld3RoZW9yZW17cHJvcG9zaXRpb259
e1Byb3Bvc2l0aW9ufVtzZWN0aW9uXQpcbmV3dGhlb3JlbXtjb3JvbGxhcnl9e0Nvcm9sbGFyeX1b
c2VjdGlvbl0KXG5ld3RoZW9yZW17ZGVmaW5pdGlvbn17RGVmaW5pdGlvbn1bc2VjdGlvbl0KXG5l
d3RoZW9yZW17Y29uamVjdHVyZX17Q29uamVjdHVyZX1bc2VjdGlvbl0KXHJlbmV3Y29tbWFuZCp7
XHByb29mbmFtZX17UHJvb2Z9CgoKCiUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlCiUg
ICAgICBFeGFtcGxlIGVudmlyb25tZW50ICAgICAlCiUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUl
JSUlJSUlClxuZXd0aGVvcmVte2V4YW1wbGV9e0V4YW1wbGV9W3NlY3Rpb25d
"""
preamble_dk = """JSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJQolIFNldHRpbmdzIGZvciBkb2N1bWVu
dCAoZGFuaXNoKSAlCiUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUKCiUgSW5wdXQg
Y29tbW9uIGRlZmluaXRpb24KXGlucHV0e3ByZWFtYmxlX2Jhc2UudGV4fQoKJSUlJSUlJSUlJSUl
JSUlJSUlJSUlJSUlJSUlJSUlJSUKJSAgIEVuY29kaW5nIGFuZCBoeXBoZW5hdGlvbiAgICUKJSUl
JSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUKJSBCYXNpY3M6IGZvbnQsIGNvZGVjIGV0Yy4K
XHVzZXBhY2thZ2VbZGFuaXNoXXtiYWJlbH0JCQkJCQklIGJhYmVsIGlzIGZvciBoeXBoZW5hdGlv
biBhbmQgb3RoZXIgZ29vZGllcwpccmVuZXdjb21tYW5ke1xkYW5pc2hoeXBoZW5taW5zfXsyMn0J
CQklIGV2ZW4gYmV0dGVyIGRhbmlzaCBoeXBoZW5hdGlvbiEKCiUgLmJpYiBkYW5pc2ggcmVkZWZp
bml0aW9uIGZvciBhdXRob3IgaW4gdGl0bGUKXHJlbmV3Y29tbWFuZFxBdXRoYW5keyBvZyB9Clxy
ZW5ld2NvbW1hbmRcQXV0aGFuZHN7LCBvZyB9ClxyZW5ld2NvbW1hbmRcQWZmaWxmb250e1xzbWFs
bH0KCgoKJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUKJSAgICAgICAgIGxzdGxpc3Rp
bmcgICAgICAgICAgICUKJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUKCiUgbHN0bGlz
dGluZyBsYW5ndWFnZSByZWRlZmluaXRpb25zClxyZW5ld2NvbW1hbmR7XGxzdGxpc3RpbmduYW1l
fXtLb2RlfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJSBmb3Ig
b25lIGJsb2NrIG9mIGNvZGUgYWxvbmUKXHJlbmV3Y29tbWFuZHtcbHN0bGlzdGxpc3RpbmduYW1l
fXtMaXN0ZSBhZiBcbHN0bGlzdGluZ25hbWUgcn0gICAgICAgICAgICAgICAgICAlIGZvciBtb3Jl
IHBpZWNlcyBvZiBjb2RlIGluIG9uZQoKCgolJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUl
JQolICAgICAgTG9naWMgYW5kIHByb29mcyAgICAgICAgJQolJSUlJSUlJSUlJSUlJSUlJSUlJSUl
JSUlJSUlJSUlJQolIFRoZW9yZW0gZW52aXJvbm1lbnRzClxuZXd0aGVvcmVte3RoZW9yZW19e1PD
pnRuaW5nfVtzZWN0aW9uXQpcbmV3dGhlb3JlbXtsZW1tYX17TGVtbWF9W3NlY3Rpb25dClxuZXd0
aGVvcmVte3Byb3Bvc2l0aW9ufXtQcm9wb3NpdGlvbn1bc2VjdGlvbl0KXG5ld3RoZW9yZW17Y29y
b2xsYXJ5fXtLb3JvbGxhcn1bc2VjdGlvbl0KXG5ld3RoZW9yZW17ZGVmaW5pdGlvbn17RGVmaW5p
dGlvbn1bc2VjdGlvbl0KXG5ld3RoZW9yZW17Y29uamVjdHVyZX17Rm9ybW9kbmluZ31bc2VjdGlv
bl0KXHJlbmV3Y29tbWFuZCp7XHByb29mbmFtZX17QmV2aXN9CgoKJSUlJSUlJSUlJSUlJSUlJSUl
JSUlJSUlJSUlJSUlJSUKJSAgICAgIEV4YW1wbGUgZW52aXJvbm1lbnQgICAgICUKJSUlJSUlJSUl
JSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUKXG5ld3RoZW9yZW17ZXhhbXBsZX17RWtzZW1wZWx9W3Nl
Y3Rpb25dCgoKCiUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlCiUgICAgICAgVGl0bGUg
YW5kIGxheW91dCAgICAgICAlCiUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlClxzZXR2
YWx1ZXtvZiA9IGFmfQo=
"""

    
parser = argparse.ArgumentParser(description='Make a LaTeX project from Steffan\'s awesome template')
parser.add_argument('path', type=str, nargs='+', help='the path to build the project')
parser.add_argument('-l', type=str, nargs=1, help='the language of the preamble, "en" or "dk"', default=["en"])
parser.add_argument('--zip', dest='zip', action='store_const', const=True, default=False, help='zip the resulting project')
#TODO: Add -c option to clean folders first / after
args = parser.parse_args()

preamble_locale = 'preamble_dk' if args.l[0] == 'dk' else 'preamble_en'
preamble_l_content = preamble_dk if args.l[0] == 'dk' else preamble_en
preamble_l_content = base64.decodestring( preamble_l_content )
preamble_base_content = base64.decodestring( preamble_base )
template_content = base64.decodestring( template )

#TODO: make this specifiable in the prepare.py
######## MODIFICATIONS ########

template_content = template_content.replace( '\subimport{../preamble/}{preamble_en.tex}',
'\subimport{preamble/}{' + preamble_locale + '.tex}')

###############################

PATH = " ".join(args.path)
if not os.path.exists(PATH):
    os.makedirs(PATH)
os.chdir(PATH)
if not os.path.exists('preamble'):
    os.mkdir('preamble')
with open(os.path.join('preamble', preamble_locale + '.tex'), 'w') as preamble_l_file:
    preamble_l_file.write(preamble_l_content)

with open(os.path.join('preamble', 'preamble_base.tex'), 'w') as preamble_base_file:
    preamble_base_file.write(preamble_base_content)

with open('template.tex', 'w') as template_file:
    template_file.write(template_content)

if args.zip:
    fname = os.getcwd() #includes the filepath, sice we cd'ed to it
    import zipfile
    zipf = zipfile.ZipFile(fname + '.zip', 'w', zipfile.ZIP_DEFLATED)
    zipf.write(os.path.join('preamble', preamble_locale + '.tex'))
    zipf.write(os.path.join('preamble', 'preamble_base.tex'))
    zipf.write('template.tex')
    zipf.close()
raw_input('Success, Press enter to exit')
